/* App Layout Components */

@layer components {
  .app-container {
    @apply min-h-screen bg-background text-foreground flex flex-col;
  }

  .main-content {
    @apply w-full mx-auto px-4 sm:px-6 lg:px-8;
    @apply flex-1 flex flex-col;
  }

  .app-header { @apply text-center mb-8; }
  .app-header__title-wrapper { @apply flex justify-center items-center gap-4 mb-2; }
  .app-header__icon { @apply h-10 w-10 text-primary; }
  .app-header__title { @apply text-4xl sm:text-5xl font-extrabold text-foreground tracking-tight; }
  .app-header__subtitle { @apply text-muted-foreground max-w-2xl mx-auto; }
  .app-footer { @apply text-center mt-12 text-muted-foreground text-sm; }

  .view-controls {
    @apply flex justify-center items-center gap-4 mb-8;
  }

  .view-switcher {
    @apply flex justify-center bg-nav-background p-2 rounded-lg gap-2;
  }

  .nav-button {
    @apply px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background;
  }
  .nav-button:not(.nav-button--active) {
    @apply bg-nav-background text-nav-foreground hover:bg-muted;
  }
  .nav-button--active {
    @apply bg-nav-active text-nav-active-foreground;
  }

  /* ToggleSwitch Component */
  .toggle-switch {
    @apply flex items-center justify-center space-x-2;
  }

  .toggle-switch__label {
    @apply font-medium transition-colors text-muted-foreground;
  }
  .toggle-switch__label--active {
    @apply text-primary;
  }

  .toggle-switch__button {
    @apply relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-ring;
  }
  .toggle-switch__button--on { @apply bg-primary; }
  .toggle-switch__button--off { @apply bg-muted; }

  .toggle-switch__slider {
    @apply inline-block h-5 w-5 rounded-full bg-background shadow transform ring-0 transition ease-in-out duration-200;
  }
  .toggle-switch__slider--on { @apply translate-x-5; }
  .toggle-switch__slider--off { @apply translate-x-0; }

  /* Question-Driven Music Tool Layout */
  .question-driven-music-tool {
    @apply w-full flex-1 flex flex-col;
  }

  .tool-content {
    @apply flex gap-6;
  }

  /* New layout with sidebar similar to example_layout.html */
  .tool-content-with-sidebar {
    @apply flex flex-1 overflow-hidden mt-6;
  }

  .main-panel {
    @apply flex-1 min-w-0;
  }

  /* Adjust main panel when sidebar is visible to prevent overlap */
  .tool-content-with-sidebar--with-sidebar .main-panel {
    @apply pr-80 lg:pr-96;
  }

  /* Analysis Results Sidebar - matches example layout */
  .analysis-results-sidebar {
    @apply w-80 lg:w-96 flex-shrink-0;
    @apply fixed top-0 right-0 h-screen overflow-y-auto z-40;
    @apply bg-card border-l border-border;
    @apply transition-transform duration-300 ease-in-out;
  }

  .analysis-results-sidebar--hidden {
    @apply transform translate-x-full opacity-0 pointer-events-none;
  }

  /* Custom scrollbar styling for sidebar */
  .analysis-results-sidebar::-webkit-scrollbar {
    width: 8px;
  }

  .analysis-results-sidebar::-webkit-scrollbar-track {
    background: var(--muted);
  }

  .analysis-results-sidebar::-webkit-scrollbar-thumb {
    background-color: var(--border);
    border-radius: 4px;
    border: 2px solid var(--muted);
  }

  /* Fixed Analysis Sidebar that moves with scroll and sizes with content */
  .analysis-sidebar {
    position: fixed;
    top: 5rem;
    right: 1.5rem;
    width: auto; /* Size based on content */
    min-width: 20rem; /* Minimum width for readability */
    max-width: 30rem; /* Maximum width to prevent excessive size */
    background-color: var(--card);
    border: 1px solid var(--border);
    padding: 1.5rem; /* p-6 */
    border-radius: 0.5rem; /* rounded-lg for a softer look */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    overflow-y: auto; /* Enable scrolling if content overflows */
    max-height: calc(100vh - 5rem); /* Full height minus top offset */
    height: auto; /* Size based on content height */
    z-index: 10; /* Ensure it stays above other content */
    color: var(--card-foreground);
  }

  /* Basic scrollbar styling for better aesthetics */
  .analysis-sidebar::-webkit-scrollbar {
    width: 8px;
  }

  .analysis-sidebar::-webkit-scrollbar-track {
    background: var(--muted);
  }

  .analysis-sidebar::-webkit-scrollbar-thumb {
    background-color: var(--border);
    border-radius: 4px;
    border: 2px solid var(--muted);
  }

  /* Main content area adjustments when sidebar is visible */
  .with-sidebar {
    margin-right: 22rem; /* Account for sidebar min-width + padding + margin */
  }

  /* Responsive adjustments for smaller screens */
  @media (max-width: 1200px) {
    .with-sidebar {
      margin-right: 0; /* Remove margin on smaller screens */
    }

    .analysis-sidebar {
      position: fixed;
      top: 1rem;
      right: 1rem;
      left: 1rem;
      width: auto;
      min-width: auto;
      max-width: none;
    }
  }

  /* Analysis Results Toggle Button (FAB) */
  .analysis-toggle-fab {
    @apply fixed bottom-6 right-6 z-50;
  }

  .analysis-toggle-fab__btn {
    @apply relative flex items-center justify-center w-14 h-14 bg-primary text-primary-foreground rounded-full shadow-lg hover:shadow-xl transition-all duration-200 ease-in-out;
    @apply focus:outline-none focus:ring-4 focus:ring-ring;
  }
  .analysis-toggle-fab__btn:hover {
    background-color: color-mix(in oklch, var(--primary) 90%, transparent);
    @apply transform scale-110;
  }

  .analysis-toggle-fab__badge {
    @apply absolute -top-2 -right-2 bg-destructive text-destructive-foreground text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center;
    @apply min-w-6 px-1;
  }

  /* Responsive adjustments for mobile */
  @media (max-width: 768px) {
    .analysis-toggle-fab {
      @apply bottom-4 right-4;
    }

    .analysis-toggle-fab__btn {
      @apply w-12 h-12;
    }

    .analysis-toggle-fab__badge {
      @apply w-5 h-5 text-xs;
    }
  }

  /* Tab Content Wrapper - creates layout for tab content and results */
  .tab-content-wrapper {
    @apply space-y-6;
  }

  /* Tab with Results Layout */
  .tab-with-results {
    @apply flex gap-6;
  }

  .tab-with-results .mode-identification-tab,
  .tab-with-results .mode-discovery-tab,
  .tab-with-results .harmony-tab,
  .tab-with-results .reference-tab {
    @apply flex-1 min-w-0;
  }

  .tab-with-results .unified-results-container {
    @apply w-96 flex-shrink-0;
  }

  .results-sidebar {
    @apply w-80 flex-shrink-0;
  }

  .debug-panel {
    @apply mt-8 p-4 rounded-lg border;
    background-color: color-mix(in oklch, var(--muted) 50%, transparent);
    border-color: color-mix(in oklch, var(--warning) 50%, transparent);
  }

  /* User Inputs Display Section */
  .user-inputs-section {
    @apply mb-6 p-4 rounded-lg border border-border;
    background-color: color-mix(in oklch, var(--muted) 50%, transparent);
  }

  .user-inputs-section h4 {
    @apply text-lg font-semibold text-primary mb-3;
  }

  .user-inputs-content {
    @apply space-y-2;
  }

  .input-display {
    @apply flex flex-col space-y-1;
  }

  .input-label {
    @apply text-sm font-medium text-muted-foreground;
  }

  .input-value {
    @apply text-foreground bg-input px-3 py-2 rounded border border-border font-mono text-sm;
    word-break: break-word;
  }

  .input-meta {
    @apply flex items-center justify-between text-xs text-muted-foreground;
  }

  .input-method {
    @apply capitalize;
  }

  .input-error {
    @apply text-destructive font-medium;
  }

  .input-actions {
    @apply mt-3 flex justify-start;
  }

  /* History Input Display */
  .unified-results-panel__history-input {
    @apply mt-1 mb-2 text-xs;
  }

  .history-input-label {
    @apply text-muted-foreground font-medium;
  }

  .history-input-value {
    @apply text-foreground ml-1 font-mono;
  }

  /* Unified Results Panel Controls */
  .unified-results-panel__controls {
    @apply flex items-center gap-2 ml-4;
  }

  .unified-results-panel__control-btn {
    @apply w-8 h-8 flex items-center justify-center text-muted-foreground hover:text-foreground hover:bg-muted rounded transition-colors duration-200 text-sm;
  }

  .unified-results-panel__control-btn:disabled {
    @apply opacity-50 cursor-not-allowed hover:text-muted-foreground hover:bg-transparent;
  }

  .unified-results-panel__control-btn.active {
    @apply text-primary bg-muted;
  }

  .unified-results-panel__position-controls {
    @apply flex items-center gap-1 border-r border-border pr-2 mr-2;
  }

  .unified-results-panel__close {
    @apply text-muted-foreground hover:text-foreground text-xl cursor-pointer p-1 hover:bg-muted rounded transition-colors duration-200;
  }
}
